{% extends "base.html"%}
{% block content %}
<script>
async function UserAction(method,target_id,api,text_id) {


	const data = { "target_id": target_id };
	const options = {
		method: method,
		headers: {
			'Content-Type':'application/json'
		},
		body: JSON.stringify(data)
	};

    let response = await fetch('http://gen-review.net/api/v1.0/'+api, options);

if (response.ok) { // если HTTP-статус в диапазоне 200-299
// получаем тело ответа (см. про этот метод ниже)
//document.getElementById("similar_apps_count_result").innerHTML = await JSON.stringify(response.json());
response.json().then(json => {document.getElementById(text_id).innerHTML =JSON.stringify(json);});
} else {
alert("Error HTTP: " + response.status);
}

}	
</script>

<h1>Example</h1>
<ol>
	<li class ="api_ref">
		<p class ="api_text">First you need to check if there are enough similar apps to get reviews from for your app. Similar apps are apps with similar user base and app type. <br>
		Send request <strong>http://gen-review.net/api/v1.0/similar_apps_count</strong> with json file: <strong>{'target_id': 'com.appadvisory.drawclimber'}</strong>. <strong>target_id</strong> is an id of the app you want to get reviews for.
		</p>

		<p class ="api_text"><big><strong>http://gen-review.net/api/v1.0/similar_apps_count</strong></big></p>
		<form>
			<label class ="api_text" for="target_id">'target_id'</label><br>
			<input class ="api_text" type="text" id="target_id" name="target_id" value="com.appadvisory.drawclimber"><br>
		</form>
		<button class="button api_text" type="button" onclick="UserAction('POST',document.getElementById('target_id').value,'similar_apps_count','similar_apps_count_result')">SEND</button>
		<p class ="api_text">Result: </p>
		<p  class ="api_text" id="similar_apps_count_result"></p>
	</li>
</ol>
{%endblock%}
